<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Bender.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://rasmuskh.github.io/Bender.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Bender.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Layers"><span>Layers</span></a></li><li><a class="tocitem" href="#Forward-mappings"><span>Forward mappings</span></a></li><li><a class="tocitem" href="#Similarity/correlation-functions"><span>Similarity/correlation functions</span></a></li><li><a class="tocitem" href="#Loss-functions"><span>Loss functions</span></a></li><li><a class="tocitem" href="#Activation-functions"><span>Activation functions</span></a></li></ul></li><li><a class="tocitem" href="functionindex/">Function index</a></li><li><a class="tocitem" href="notebooks/FAexample/">Example: Feedback Alignment</a></li><li><a class="tocitem" href="notebooks/Binaryexample/">Example: Binary Neural Network</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Rasmuskh/Bender.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Bender.jl"><a class="docs-heading-anchor" href="#Bender.jl">Bender.jl</a><a id="Bender.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Bender.jl" title="Permalink"></a></h1><h2 id="Layers"><a class="docs-heading-anchor" href="#Layers">Layers</a><a id="Layers-1"></a><a class="docs-heading-anchor-permalink" href="#Layers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Bender.GenDense" href="#Bender.GenDense"><code>Bender.GenDense</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Generalized version of Flux&#39;s Dense layer. The <code>forward</code> keyword allows you to choose the form of the forward mapping.</p><pre><code class="nohighlight hljs">GenDense(in=&gt;out, σ=identity; 
         init = glorot_uniform, 
         bias=true, α=false, β=false, forward=linear)</code></pre><p>Can also be initialized with an additional set of trainable weights </p><pre><code class="nohighlight hljs">GenDense(in=&gt;out, in_asym=&gt;out_asym, σ = identity; 
         init = glorot_uniform, 
         bias=true, α=false, β=false, forward=linear)</code></pre><p>The layer has additinal keyword arguments α and β, which default to Flux.Zeros. These are useful if you need an extra set of weights for for your forward pass (if you for example wish to anneal an activation function).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/layers.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.GenConv" href="#Bender.GenConv"><code>Bender.GenConv</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Generalized version of Flux&#39;s conv layer.  The <code>forward</code> keyword allows you to choose the form of the forward mapping and defaults to linear. This layer can be initialized with either one or two set of filters  (a second set of filters is useful for feedback alignment experiments).</p><pre><code class="nohighlight hljs">GenConv((k, k), ch_in=&gt;ch_out, σ=identity; forward=linear)

GenConv((k, k), ch_in=&gt;ch_out_(k_asym, k_asym), ch_in_asym=&gt;ch_out_asym, σ=identity; forward=linear)</code></pre><p>The layer has additinal keyword arguments α and β, which default to Flux.Zeros. These are useful if you need an extra set of weights for for your forward pass (if you for example wish to anneal an activation function).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/layers.jl#L91-L103">source</a></section></article><h2 id="Forward-mappings"><a class="docs-heading-anchor" href="#Forward-mappings">Forward mappings</a><a id="Forward-mappings-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-mappings" title="Permalink"></a></h2><h3 id="Forward-mappings-for-GenDense-layers"><a class="docs-heading-anchor" href="#Forward-mappings-for-GenDense-layers">Forward mappings for GenDense layers</a><a id="Forward-mappings-for-GenDense-layers-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-mappings-for-GenDense-layers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="Bender.linear" href="#Bender.linear"><code>Bender.linear</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Matrix multiply weight matrix with x and add bias</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/forwardmappings.jl#L3-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.linear_asym_∂x" href="#Bender.linear_asym_∂x"><code>Bender.linear_asym_∂x</code></a> — <span class="docstring-category">Function</span></header><section><div><p>behaves identical to <code>linear</code> in the forward pass, but relies on matmul<em>asym</em>∂x,  which causes errors to be backpropagated using a set of auxiliary weights in the backwards pass. See <code>matmul_asym_∂x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/forwardmappings.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.linear_blocked_∂x" href="#Bender.linear_blocked_∂x"><code>Bender.linear_blocked_∂x</code></a> — <span class="docstring-category">Function</span></header><section><div><p>behaves identical to <code>linear</code> in the forward pass, but relies on matmul<em>blocked</em>∂x,  which prevents error signal from passing through this layer to earlier layers.  This is useful in direct feedback alignment experiments where you want to pipe errors directly from the output loss to individual layers. See <code>matmul_blocked_∂x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/forwardmappings.jl#L21-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.radial" href="#Bender.radial"><code>Bender.radial</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Calls radialSim and computes the negative squared euclidean distance D between the rows ofthe  layers W matrix and the columns of matrix X. See <code>radialSim</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/forwardmappings.jl#L32-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.radial_asym_∂x" href="#Bender.radial_asym_∂x"><code>Bender.radial_asym_∂x</code></a> — <span class="docstring-category">Function</span></header><section><div><p>behaves identical to <code>radial</code> in the forward pass, but relies on radialSim<em>asym</em>∂x,  which causes errors to be backpropagated using a set of auxiliary weights in the backwards pass. See <code>radialSim_asym_∂x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/forwardmappings.jl#L40-L43">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>linear_binary_weights</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>linear_stoc_binary_weights</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Forward-mappings-for-GenConv-layers"><a class="docs-heading-anchor" href="#Forward-mappings-for-GenConv-layers">Forward mappings for GenConv layers</a><a id="Forward-mappings-for-GenConv-layers-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-mappings-for-GenConv-layers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="Bender.conv_linear" href="#Bender.conv_linear"><code>Bender.conv_linear</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Forward mapping for regular convolutional layer</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/forwardmappings.jl#L68-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.conv_linear_asym_∂x" href="#Bender.conv_linear_asym_∂x"><code>Bender.conv_linear_asym_∂x</code></a> — <span class="docstring-category">Function</span></header><section><div><p>In the forward pass this behaves identical to <code>conv_linear</code>.  Relies on <code>conv_asym_∂x</code>, which causes errors to be backpropagated  using a set of auxiliary weights in the backwards pass. See <code>conv_asym_∂x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/forwardmappings.jl#L78-L82">source</a></section></article><h2 id="Similarity/correlation-functions"><a class="docs-heading-anchor" href="#Similarity/correlation-functions">Similarity/correlation functions</a><a id="Similarity/correlation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Similarity/correlation-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Bender.matmul" href="#Bender.matmul"><code>Bender.matmul</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Regular matrix multiplication.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/similarity_functions.jl#L39-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.matmul_asym_∂x" href="#Bender.matmul_asym_∂x"><code>Bender.matmul_asym_∂x</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Compute matrix multiplication, but takes an additional matrix B as input.  B has same dims as Wᵀ, and is used in the backwards pass.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/similarity_functions.jl#L46-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.matmul_blocked_∂x" href="#Bender.matmul_blocked_∂x"><code>Bender.matmul_blocked_∂x</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Matrix multiplication with custom rrule</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/similarity_functions.jl#L87-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.radialSim" href="#Bender.radialSim"><code>Bender.radialSim</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Compute negative squared euclidean distance D between the rows of matrix W and the columns of matrix X. Denoting the rows of W by index i and the columns of X by index j the elements of the output matrix is given by: Dᵢⱼ = -||Wᵢ﹕ - X﹕ⱼ||² = 2Wᵢ﹕X﹕,ⱼ - ||Wᵢ﹕||^2 - ||X﹕ⱼ||².</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/similarity_functions.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.radialSim_asym" href="#Bender.radialSim_asym"><code>Bender.radialSim_asym</code></a> — <span class="docstring-category">Function</span></header><section><div><p>In the forward pass this function behaves just like radialSim, but in the backwards pass weight symmetry is broken by using matrix B rather than Wᵀ. See docstring for radialSim for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/similarity_functions.jl#L13-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.conv_asym_∂x" href="#Bender.conv_asym_∂x"><code>Bender.conv_asym_∂x</code></a> — <span class="docstring-category">Function</span></header><section><div><p>computes the convolution of image x with kernel <code>w</code> when called, but uses a different set of weights <code>w_asym</code> to compute the pullback wrt x. This is typically uses in feedback alignment experiments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/similarity_functions.jl#L67-L70">source</a></section></article><h2 id="Loss-functions"><a class="docs-heading-anchor" href="#Loss-functions">Loss functions</a><a id="Loss-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Loss-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Bender.direct_feedback_loss" href="#Bender.direct_feedback_loss"><code>Bender.direct_feedback_loss</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Error function which takes a vector of the hidden and output neurons states as well as a vector of feedback matrices as arguments</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/losses.jl#L1-L4">source</a></section></article><h2 id="Activation-functions"><a class="docs-heading-anchor" href="#Activation-functions">Activation functions</a><a id="Activation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Activation-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Bender.sign_STE" href="#Bender.sign_STE"><code>Bender.sign_STE</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Deterministic straight-through estimator for the sign function. Reference: https://arxiv.org/abs/1308.3432, https://arxiv.org/abs/1511.00363</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/activation_functions.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.stoc_sign_STE" href="#Bender.stoc_sign_STE"><code>Bender.stoc_sign_STE</code></a> — <span class="docstring-category">Function</span></header><section><div><p>A stochastic straight-through estimator version of the sign function. References: https://arxiv.org/abs/1308.3432, https://arxiv.org/abs/1511.00363</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/activation_functions.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Bender.hardσ" href="#Bender.hardσ"><code>Bender.hardσ</code></a> — <span class="docstring-category">Function</span></header><section><div><p>A piece-wise linear function. for x&lt;-1 it has value 0. For -1&lt;x&lt;1 it has value x. For x&gt;1 it has value 1. It is defined as:</p><pre><code class="nohighlight hljs">hardσ(x) = max(0, min(1, (x+1)/2))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Rasmuskh/Bender.jl/blob/c279045cf8f3e0f63c4de7beae0667d6d822cac1/src/activation_functions.jl#L20-L24">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="functionindex/">Function index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Sunday 3 July 2022 18:04">Sunday 3 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
